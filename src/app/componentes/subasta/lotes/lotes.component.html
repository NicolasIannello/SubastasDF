<div class="svh" >
    <div class="margin5 border rounded" style="width: 100%; text-align: center;">
        <span *ngIf="error==4">La publicacion aun no ha iniciado</span>
        <span *ngIf="error==5">La publicacion ha terminado</span>
        <div style="display: flex; justify-content: space-between;">
            <span>Publicacion: {{evento['nombre']}}</span>
            <span>Lotes: {{nlotes}}</span>
        </div>
        <mat-expansion-panel hideToggle class="border rounded glassAzul colorWhite" style="margin-top: 1%; margin-bottom: 1%;" [expanded]="panel">
            <mat-expansion-panel-header class="glassAzul colorWhite">
                <mat-panel-title class="glassAzul colorWhite">
                    <span class="colorWhite datoLote" style="margin: 1.5%; display: block; font-family: Avenir;">
                        <label style="text-decoration: underline; display: flex;">ATENCION</label><br>
                        Ofertando en estos lotes se estan aceptando los <i class="fa-solid fa-landmark"></i> terminos y condiciones
                    </span>
                    <span class="colorWhite datoLote" style="margin: 1.5%; display: flex; font-family: Avenir; align-items: center;">
                        <i class="fa-solid fa-bars textWhite" style="margin-right: 0.5rem; cursor: pointer;"></i>
                        <span class="textWhite" style="cursor: pointer;">Ver T&C</span>         
                    </span>
                </mat-panel-title>
            </mat-expansion-panel-header>
            <div class="col-3" style="display: flex; flex-direction: column;">
                <embed *ngIf="pdf!=null" width="100%" height="600px" [src]="pdf" type='application/pdf'>
                <mat-checkbox [(ngModel)]="tyc" (click)="panel=false; aceptarTC()" [disabled]="tyc" [class.mat-checkbox-disabled]="tyc">
                    <span  class="colorWhite" style="font-size: large;">He leido y acepto los Terminos y condiciones del lote</span>
                </mat-checkbox>
                <span  class="colorWhite" style="font-size: small;">Terminos y condiciones aceptados el: {{tycFecha}}</span>
            </div>
        </mat-expansion-panel>
        <div *ngFor="let lote of lotes; index as i" style="max-height: 100%; align-items: center; border-bottom: 1px solid rgb(48, 131, 220, 0.2); /*padding: 1%;*/">
            <span *ngIf="flagTimer[i]" class="glass" [ngClass]="{'glassAzul' : i%2 }" [ngStyle]="{'color': i%2 ? 'white' : 'black' }" style="width: 100%; display: flex; justify-content: center;">
                <i class="fa-solid fa-calendar-days" style="margin-right: 1%;"></i> Finaliza en {{totalDays[i]}} Dias {{remHours[i]}}h {{remMinutes[i]}}m {{remSeconds[i]}}s
            </span>
            <span *ngIf="!flagTimer[i]" class="glass" [ngClass]="{'glassAzul' : i%2 }" [ngStyle]="{'color': i%2 ? 'white' : 'black' }" style="width: 100%; display: flex; justify-content: center;">
                <i class="fa-solid fa-calendar-days" style="margin-right: 1%;"></i> {{lote['estado']==1 ? 'Esperando cierre' : 'Lote finalizado'}} 
            </span>
            <div style="display: flex;" [ngClass]="{'glassTrueAzul' : i%2}">
                <div *ngIf="imagenes.length>i" class="celda" style="width: 6rem; min-height: 4rem; display: flex; align-items: center; justify-content: center;">
                    <img src="{{imagenes[i].link}}" alt="" style="width: 100px; height: 64px;">
                </div>
                <div class="celda" style="width: 85%; min-height: 4rem; display: flex; align-items: center;">{{lote['titulo']}}</div>
                <div *ngIf="lote['estadoV']" class="celda" [ngClass]="{'glassAzul' : lote['estadoV']=='Visto'}" style="width: 15%; min-height: 4rem; display: flex; align-items: center; justify-content: center;" [ngStyle]="{'background-color': lote['estadoV']=='Ofertado' ? 'greenyellow' : 'none' }">{{lote['estadoV']}}</div>
                <div *ngIf="!lote['estadoV']" class="celda" style="width: 15%; min-height: 4rem; display: flex; align-items: center; justify-content: center; background-color: yellow;">No visto</div>
                <div class="celda" style="width: 20%; min-height: 4rem; display: flex; align-items: center; border: none; justify-content: center;">
                    <button class="border rounded boton botones" (click)="verLote(lote)">ver</button>
                </div>
            </div>
        </div>
    </div>
</div>

<app-lote [ngClass]="{ 'oculto':!ver }" (messageEvent)="handleMessage($event)" [lote]="loteModal" [evento]="evento" [tyc]="tyc"></app-lote>